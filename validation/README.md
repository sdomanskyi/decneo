# Validation 

This directory contains an alternative analysis pipeline that validates the results of DECNEO. 

## Overview

The validation implementation of DECNEO includes workflow for the calculation of single cell gene expression 
distance (e.g. correlation) as well as conservation, network enrichment and percent expression for the dataset. 
The results are summarized in a form of a optimized dendrogram and a dataframe containing all statistics 
generated for each gene.

## Input Data 

Expression data for **two different** species for comparison is required. 
For each of these species provide the input gene expression data is expected in the following format:

``Pandas DataFrame`` where ``axis 0`` is genes and ``axis 1`` are cells.

|        | C1 | C2 | C3| C4 |...|
|--------| ---| ---|---|----|---|
| **G1** |    | 3  | 1 | 7  |...|
| **G2** | 2  | 2  |   | 2  |...|
| **G3** | 3  | 1  | 2 | 7  |...|
| **G4** | 10 |    | 5 | 4  |...|
| **...**| ...|... |...| ...|...|

When using an expression data as the input, the `cell_list` parameter is also required. This should be set to the
list of the endothelial cells included in the input count file. 

The analysis takes in other optional parameters as well. 
Please refer to them in the ``full_data_process`` function in ``Dendro_Dict.py``

## Usage Example

We have included a sample execution file ``example.py`` that shows how to run the validation analysis.

To execute the validation analysis first create an execution file. In this is execution file:
- [x] Load in all necessary packages and functions
- [x] Load in any parameters of interest 
- [x] Load in input files for both species 
- [x] Run ``full_data_process`` on first species of interest
- [x] Run ``full_data_process`` on second species of interst
  - Set ``compare_dendro`` parameter to the full genes statistics dictionary outputted in the previous step in order 
  to calculate conservation

See details of the script ```example.py``` at:
> [Example walkthrough of example.py script](https://github.com/sdomanskyi/decneo/blob/master/validation/example.py)

## Output Directories and Files

Outputs resulting figure to the directory the function is run in and outputs all resulting directories and files to 
directory specified as the ``saveDir`` when running the ``full_data_process`` function. 

- **tmp.png:** dendrogram and heatmap plotted using data generated by the ``full_data_process`` function 
- **save_dir:** directory containing all resulting directories and files 
  - **Corr_BS:** folder of correlation for each sample/pseudo sample
    - **Full_Corr.csv:** file containing correlation of all genes 
  - **diff_BS:** folder of differential expression for each sample/pseudo sample
    - **Full_Diff.csv:** file containing differential expression of all genes 
  - **gene_stats_Full.csv:** list of all statistics generated for each gene
